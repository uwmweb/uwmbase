{"version":3,"sources":["search-locations.tmp.js"],"names":["$","Drupal","behaviors","uwmSearchMap","attach","context","settings","initAll","map","infoWindow","geocoder","submit","focus","blur","find","focusout","s","val","text","geocodeAddress","getMapCenter","initMap","getMapRadiusLength","google","maps","Map","document","getElementById","center","lat","lng","zoom","InfoWindow","Geocoder","navigator","geolocation","getCurrentPosition","position","pos","coords","latitude","longitude","setPosition","setContent","open","setCenter","handleLocationError","getCenter","browserHasGeolocation","bounds","getBounds","ne","getNorthEast","radius","geometry","spherical","computeDistanceBetween","resultsMap","search","address","value","geocode","results","status","location","marker","Marker","alert","jQuery"],"mappings":"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","file":"search-locations.tmp.js","sourcesContent":["\"use strict\";\n\n/**\n * @file\n * Custom JavaScript for UW Medicine.\n */\n\n(function($, Drupal) {\n\n  Drupal.behaviors.uwmSearchMap = {\n    attach: function attach(context, settings) {\n      initAll();\n    }\n  };\n\n  var map = void 0;\n  var infoWindow = void 0;\n  var geocoder = void 0;\n\n  function initAll() {\n    $(\"form.views-exposed-form\").submit(function() {});\n\n    var focus = 0;\n\n    var blur = 0;\n\n    $(\"form.views-exposed-form\")\n      .find(\"input[name=s]\")\n      .focusout(function() {\n        focus++;\n        var s = $(this).val();\n        $(\"#focus-count\").text(\"focusout fired: \" + focus + \"x\" + s);\n        geocodeAddress(geocoder, map, s);\n        getMapCenter();\n        initMap();\n        getMapRadiusLength();\n        geocodeAddress();\n      })\n      .blur(function() {\n        blur++;\n        var s = $(this).val();\n        $(\"#blur-count\").text(\"blur fired: \" + blur + \"x \" + s);\n      });\n  }\n\n  function initMap() {\n    map = new google.maps.Map(document.getElementById(\"map\"), {\n      center: { lat: -34.397, lng: 150.644 },\n      zoom: 6\n    });\n\n    infoWindow = new google.maps.InfoWindow();\n    geocoder = new google.maps.Geocoder();\n\n    // Try HTML5 geolocation.\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(\n        function(position) {\n          var pos = {\n            lat: position.coords.latitude,\n            lng: position.coords.longitude\n          };\n\n          infoWindow.setPosition(pos);\n          infoWindow.setContent(\"Location found.\");\n          infoWindow.open(map);\n          map.setCenter(pos);\n        },\n        function() {\n          handleLocationError(true, infoWindow, map.getCenter());\n        }\n      );\n    } else {\n      // Browser doesn't support Geolocation\n      handleLocationError(false, infoWindow, map.getCenter());\n    }\n  }\n\n  function handleLocationError(browserHasGeolocation, infoWindow, pos) {\n    infoWindow.setPosition(pos);\n    infoWindow.setContent(\n      browserHasGeolocation\n        ? \"Error: The Geolocation service failed.\"\n        : \"Error: Your browser doesn't support geolocation.\"\n    );\n    infoWindow.open(map);\n  }\n\n  function getMapCenter() {\n    return map.getCenter();\n  }\n\n  function getMapRadiusLength() {\n    var bounds = map.getBounds();\n    var center = map.getCenter();\n    if (bounds && center) {\n      var ne = bounds.getNorthEast();\n      // Calculate radius (in meters).\n      var radius = google.maps.geometry.spherical.computeDistanceBetween(\n        center,\n        ne\n      );\n    }\n  }\n\n  function geocodeAddress(geocoder, resultsMap, search) {\n    var address = search || document.getElementById(\"address\").value;\n    geocoder.geocode({ address: address }, function(results, status) {\n      if (status === \"OK\") {\n        resultsMap.setCenter(results[0].geometry.location);\n        var marker = new google.maps.Marker({\n          map: resultsMap,\n          position: results[0].geometry.location\n        });\n      } else {\n        alert(\"Geocode was not successful for the following reason: \" + status);\n      }\n    });\n  }\n\n\n\n})(jQuery, Drupal);\n"]}