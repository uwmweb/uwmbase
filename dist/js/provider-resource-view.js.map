{"version":3,"sources":["provider-resource-view.js"],"names":["$","Drupal","behaviors","uwmedProviderResourcesLinkGenerator","attach","context","settings","filterElement","length","wrap","insertAfter","prependTo","on","event","input","target","parent","prev","querystring","generateQueryString","history","pushState","location","pathname","join","clicked","checked","each","index","element","name","value","copyToClipboard","str","el","document","createElement","setAttribute","style","position","left","body","appendChild","selected","getSelection","rangeCount","getRangeAt","select","execCommand","removeChild","removeAllRanges","addRange","e","url","origin","text","$groups","heading","previousElementSibling","console","log","innerText","children","collapsedElements","collapseWrap","parseHTML","collapseAfter","wrapAll","collapseContainer","toggleViewMoreText","specialtyInfo1","specialtyInfo2","specialtyInfo3","specialties","drupalSettings","id","attr","split","description","spec","remove","jQuery"],"mappings":"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","file":"provider-resource-view.js","sourcesContent":["/**\n * @file\n * Javascript for the /provider-resource page.\n */\n\n(function ($, Drupal) {\n\n    Drupal.behaviors.uwmedProviderResourcesLinkGenerator = {\n\n        attach: function (context, settings) {\n\n            var filterElement = $('.view-filters');\n            if( filterElement.length == 0 ) {\n                // if there's a view <header> element we lost our views-header and views-filter divs\n                // let's add them back in\n                $('.views-exposed-form.bef-exposed-form').wrap('<div class=\"view-filters\"></div>');\n                // var viewsFilter = $.parseHTML('<div class=\"views-filter\"></div>');\n                // viewsFilter = $(viewsFilter).prepend(form);\n                // $(form).replaceWith(viewsFilter);\n                //$('.js-share-search').insertAfter('.views-exposed-form.bef-exposed-form');\n                //console.log('moved js share-search with <header> element');\n                //$('.js-filter-heading').insertBefore('.views-exposed-form.bef-exposed-form');\n            } //else {\n                // move the header to below the fitlers\n                $('.js-share-search').insertAfter('.view-filters');\n                $('.js-filter-heading').prependTo('.view-filters');\n            //}\n            \n            // update the query string when a user clicks a filter so we can maintain the selections if the user navigates to a resource\n            // and then pushes back to return to the filter\n            $('#views-exposed-form-uwm-provider-resources-uwm-provider-resources-block label').on('click', function(event) {\n                var input = $(event.target).parent().prev();\n                var querystring = generateQueryString(input[0]);\n                history.pushState(null, '', [location.pathname, querystring].join(''));\n            });\n\n            function generateQueryString(clicked = null) {\n                var checked = $('#views-exposed-form-uwm-provider-resources-uwm-provider-resources-block input[checked=checked]');\n                \n                var querystring = '?';\n    \n                $.each(checked, function(index, element) {\n                    if( clicked && element.name == clicked.name) {\n                        querystring += clicked.name + '=' + clicked.value; \n                    } else {\n                        querystring += element.name + '=' + element.value; \n                    }\n\n                    if(checked[index+1]){\n                        querystring += '&';\n                    } else {\n                        querystring += '#filter';\n                    }\n                });\n                return querystring;\n            }\n\n\n            // inspired by https://gist.github.com/Chalarangelo/4ff1e8c0ec03d9294628efbae49216db#file-copytoclipboard-js\n            function copyToClipboard(str) {\n                var el = document.createElement('textarea');  // Create a <textarea> element\n                el.value = str;                                 // Set its value to the string that you want copied\n                el.setAttribute('readonly', '');                // Make it readonly to be tamper-proof\n                el.style.position = 'absolute';                 \n                el.style.left = '-9999px';                      // Move outside the screen to make it invisible\n                document.body.appendChild(el);                  // Append the <textarea> element to the HTML document\n                var selected =            \n                document.getSelection().rangeCount > 0        // Check if there is any content selected previously\n                    ? document.getSelection().getRangeAt(0)     // Store selection if found\n                    : false;                                    // Mark as false to know no selection existed before\n                el.select();                                    // Select the <textarea> content\n                document.execCommand('copy');                   // Copy - only works as a result of a user action (e.g. click events)\n                document.body.removeChild(el);                  // Remove the <textarea> element\n                if (selected) {                                 // If a selection existed before copying\n                document.getSelection().removeAllRanges();    // Unselect everything on the HTML document\n                document.getSelection().addRange(selected);   // Restore the original selection\n                }\n            };\n\n            $('.js-link-copy').on('click', function(e) {\n                var querystring = generateQueryString();\n                var url = [location.origin, location.pathname, querystring].join('');\n                copyToClipboard(url);\n                $(e.target).text('Link copied!')\n\n            });\n\n            // add view more collapsibles around result groups\n            var $groups = $('.views-view-grid');\n            $groups.each(function(index, element) {\n                var heading = element.previousElementSibling;\n                console.log(heading.innerText + ' has ' + $(element).children('.card-deck').length + ' rows.');\n\n                if($(element).children('.card-deck').length > 2) {\n                    var collapsedElements = $(element).children(':nth-child(n+3)');\n                    var collapseWrap = $.parseHTML('<div class=\"collapse\" id=\"viewMoreCollapse' + heading.innerText + '\"></div>');\n                    var collapseAfter = $.parseHTML('<p><a aria-controls=\"viewMoreCollapse' + heading.innerText + '\" aria-expanded=\"false\" class=\"view-more-link collapsed\" data-target=\"#viewMoreCollapse' + heading.innerText + '\" data-toggle=\"collapse\" role=\"button\">View More</a></p>');\n                    $(collapsedElements).wrapAll(collapseWrap);\n                    var collapseContainer = $(collapsedElements).parent();\n                    $(collapseAfter).insertAfter(collapseContainer);\n                }\n            });\n\n            // make sure the view more events are added to our dynamically created view more elements\n            Drupal.behaviors.toggleViewMoreText.attach();\n\n            var specialtyInfo1 = '<div class=\"provider-resource-specialty\"><h3>';\n            var specialtyInfo2 = '</h3>'\n            var specialtyInfo3 = '</div>'\n            var specialties = drupalSettings['specialtyDescriptions'];\n\n            // $('.form-item-specialty label.option').on('click', function(){\n            //     var id = $(this).attr('for').split('edit-specialty-')[1];\n            //     console.log(id);\n            // })\n\n            var id = $('.form-item-specialty .btn-teal label').attr('for').split('edit-specialty-')[1].split('-')[0];\n            var element = specialtyInfo1 + specialties[id].name + specialtyInfo2;\n            if(specialties[id].description) {\n                var element = element + specialties[id].description;\n            }\n            var element = element + specialtyInfo3;\n            $(element).insertAfter('.js-share-search');\n            var spec = $('.provider-resource-specialty');\n            if (spec.length > 1) {\n                $('.provider-resource-specialty')[1].remove();\n            }\n        }\n    }\n})(jQuery, Drupal);\n\n"]}