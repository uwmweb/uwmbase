{"version":3,"sources":["provider-resource-view.js"],"names":["$","Drupal","behaviors","uwmedProviderResourcesLinkGenerator","attach","context","settings","insertAfter","on","event","input","target","parent","prev","querystring","generateQueryString","history","pushState","location","pathname","join","clicked","checked","each","index","element","name","value","copyToClipboard","str","el","document","createElement","setAttribute","style","position","left","body","appendChild","selected","getSelection","rangeCount","getRangeAt","select","execCommand","removeChild","removeAllRanges","addRange","e","url","origin","text","$groups","heading","previousElementSibling","console","log","innerText","children","length","collapsedElements","collapseWrap","parseHTML","collapseAfter","wrapAll","collapseContainer","toggleViewMoreText","jQuery"],"mappings":";;AAAA;;;;;AAKA,CAAC,UAAUA,CAAV,EAAaC,MAAb,EAAqB;;AAElBA,WAAOC,SAAP,CAAiBC,mCAAjB,GAAuD;;AAEnDC,gBAAQ,gBAAUC,OAAV,EAAmBC,QAAnB,EAA6B;;AAEjC;AACAN,cAAE,cAAF,EAAkBO,WAAlB,CAA8B,eAA9B;;AAEA;AACA;AACAP,cAAE,+EAAF,EAAmFQ,EAAnF,CAAsF,OAAtF,EAA+F,UAASC,KAAT,EAAgB;AAC3G,oBAAIC,QAAQV,EAAES,MAAME,MAAR,EAAgBC,MAAhB,GAAyBC,IAAzB,EAAZ;AACA,oBAAIC,cAAcC,oBAAoBL,MAAM,CAAN,CAApB,CAAlB;AACAM,wBAAQC,SAAR,CAAkB,IAAlB,EAAwB,EAAxB,EAA4B,CAACC,SAASC,QAAV,EAAoBL,WAApB,EAAiCM,IAAjC,CAAsC,EAAtC,CAA5B;AACH,aAJD;;AAMA,qBAASL,mBAAT,GAA6C;AAAA,oBAAhBM,OAAgB,uEAAN,IAAM;;AACzC,oBAAIC,UAAUtB,EAAE,gGAAF,CAAd;;AAEA,oBAAIc,cAAc,GAAlB;;AAEAd,kBAAEuB,IAAF,CAAOD,OAAP,EAAgB,UAASE,KAAT,EAAgBC,OAAhB,EAAyB;AACrC,wBAAIJ,WAAWI,QAAQC,IAAR,IAAgBL,QAAQK,IAAvC,EAA6C;AACzCZ,uCAAeO,QAAQK,IAAR,GAAe,GAAf,GAAqBL,QAAQM,KAA5C;AACH,qBAFD,MAEO;AACHb,uCAAeW,QAAQC,IAAR,GAAe,GAAf,GAAqBD,QAAQE,KAA5C;AACH;;AAED,wBAAGL,QAAQE,QAAM,CAAd,CAAH,EAAoB;AAChBV,uCAAe,GAAf;AACH,qBAFD,MAEO;AACHA,uCAAe,SAAf;AACH;AACJ,iBAZD;AAaA,uBAAOA,WAAP;AACH;;AAGD;AACA,qBAASc,eAAT,CAAyBC,GAAzB,EAA8B;AAC1B,oBAAIC,KAAKC,SAASC,aAAT,CAAuB,UAAvB,CAAT,CAD0B,CACoB;AAC9CF,mBAAGH,KAAH,GAAWE,GAAX,CAF0B,CAEsB;AAChDC,mBAAGG,YAAH,CAAgB,UAAhB,EAA4B,EAA5B,EAH0B,CAGsB;AAChDH,mBAAGI,KAAH,CAASC,QAAT,GAAoB,UAApB;AACAL,mBAAGI,KAAH,CAASE,IAAT,GAAgB,SAAhB,CAL0B,CAKsB;AAChDL,yBAASM,IAAT,CAAcC,WAAd,CAA0BR,EAA1B,EAN0B,CAMsB;AAChD,oBAAIS,WACJR,SAASS,YAAT,GAAwBC,UAAxB,GAAqC,CAArC,CAA8C;AAA9C,kBACMV,SAASS,YAAT,GAAwBE,UAAxB,CAAmC,CAAnC,CADN,CACgD;AADhD,kBAEM,KAHN,CAP0B,CAUsB;AAChDZ,mBAAGa,MAAH,GAX0B,CAWsB;AAChDZ,yBAASa,WAAT,CAAqB,MAArB,EAZ0B,CAYsB;AAChDb,yBAASM,IAAT,CAAcQ,WAAd,CAA0Bf,EAA1B,EAb0B,CAasB;AAChD,oBAAIS,QAAJ,EAAc;AAAkC;AAChDR,6BAASS,YAAT,GAAwBM,eAAxB,GADc,CACgC;AAC9Cf,6BAASS,YAAT,GAAwBO,QAAxB,CAAiCR,QAAjC,EAFc,CAEgC;AAC7C;AACJ;;AAEDvC,cAAE,eAAF,EAAmBQ,EAAnB,CAAsB,OAAtB,EAA+B,UAASwC,CAAT,EAAY;AACvC,oBAAIlC,cAAcC,qBAAlB;AACA,oBAAIkC,MAAM,CAAC/B,SAASgC,MAAV,EAAkBhC,SAASC,QAA3B,EAAqCL,WAArC,EAAkDM,IAAlD,CAAuD,EAAvD,CAAV;AACAQ,gCAAgBqB,GAAhB;AACAjD,kBAAEgD,EAAErC,MAAJ,EAAYwC,IAAZ,CAAiB,cAAjB;AAEH,aAND;;AAQA;AACA,gBAAIC,UAAUpD,EAAE,kBAAF,CAAd;AACAoD,oBAAQ7B,IAAR,CAAa,UAASC,KAAT,EAAgBC,OAAhB,EAAyB;AAClC,oBAAI4B,UAAU5B,QAAQ6B,sBAAtB;AACAC,wBAAQC,GAAR,CAAYH,QAAQI,SAAR,GAAoB,OAApB,GAA8BzD,EAAEyB,OAAF,EAAWiC,QAAX,CAAoB,YAApB,EAAkCC,MAAhE,GAAyE,QAArF;;AAEA,oBAAG3D,EAAEyB,OAAF,EAAWiC,QAAX,CAAoB,YAApB,EAAkCC,MAAlC,GAA2C,CAA9C,EAAiD;AAC7C,wBAAIC,oBAAoB5D,EAAEyB,OAAF,EAAWiC,QAAX,CAAoB,iBAApB,CAAxB;AACA,wBAAIG,eAAe7D,EAAE8D,SAAF,CAAY,+CAA+CT,QAAQI,SAAvD,GAAmE,UAA/E,CAAnB;AACA,wBAAIM,gBAAgB/D,EAAE8D,SAAF,CAAY,0CAA0CT,QAAQI,SAAlD,GAA8D,yFAA9D,GAA0JJ,QAAQI,SAAlK,GAA8K,0DAA1L,CAApB;AACAzD,sBAAE4D,iBAAF,EAAqBI,OAArB,CAA6BH,YAA7B;AACA,wBAAII,oBAAoBjE,EAAE4D,iBAAF,EAAqBhD,MAArB,EAAxB;AACAZ,sBAAE+D,aAAF,EAAiBxD,WAAjB,CAA6B0D,iBAA7B;AACH;AACJ,aAZD;;AAcA;AACAhE,mBAAOC,SAAP,CAAiBgE,kBAAjB,CAAoC9D,MAApC;AACH;AApFkD,KAAvD;AAsFH,CAxFD,EAwFG+D,MAxFH,EAwFWlE,MAxFX","file":"provider-resource-view.js","sourcesContent":["/**\n * @file\n * Javascript for the /provider-resource page.\n */\n\n(function ($, Drupal) {\n\n    Drupal.behaviors.uwmedProviderResourcesLinkGenerator = {\n\n        attach: function (context, settings) {\n\n            // move the header to below the fitlers\n            $('.view-header').insertAfter('.view-filters')\n            \n            // update the query string when a user clicks a filter so we can maintain the selections if the user navigates to a resource\n            // and then pushes back to return to the filter\n            $('#views-exposed-form-uwm-provider-resources-uwm-provider-resources-block label').on('click', function(event) {\n                var input = $(event.target).parent().prev();\n                var querystring = generateQueryString(input[0]);\n                history.pushState(null, '', [location.pathname, querystring].join(''));\n            });\n\n            function generateQueryString(clicked = null) {\n                var checked = $('#views-exposed-form-uwm-provider-resources-uwm-provider-resources-block input[checked=checked]');\n                \n                var querystring = '?';\n    \n                $.each(checked, function(index, element) {\n                    if( clicked && element.name == clicked.name) {\n                        querystring += clicked.name + '=' + clicked.value; \n                    } else {\n                        querystring += element.name + '=' + element.value; \n                    }\n\n                    if(checked[index+1]){\n                        querystring += '&';\n                    } else {\n                        querystring += '#filter';\n                    }\n                });\n                return querystring;\n            }\n\n\n            // inspired by https://gist.github.com/Chalarangelo/4ff1e8c0ec03d9294628efbae49216db#file-copytoclipboard-js\n            function copyToClipboard(str) {\n                var el = document.createElement('textarea');  // Create a <textarea> element\n                el.value = str;                                 // Set its value to the string that you want copied\n                el.setAttribute('readonly', '');                // Make it readonly to be tamper-proof\n                el.style.position = 'absolute';                 \n                el.style.left = '-9999px';                      // Move outside the screen to make it invisible\n                document.body.appendChild(el);                  // Append the <textarea> element to the HTML document\n                var selected =            \n                document.getSelection().rangeCount > 0        // Check if there is any content selected previously\n                    ? document.getSelection().getRangeAt(0)     // Store selection if found\n                    : false;                                    // Mark as false to know no selection existed before\n                el.select();                                    // Select the <textarea> content\n                document.execCommand('copy');                   // Copy - only works as a result of a user action (e.g. click events)\n                document.body.removeChild(el);                  // Remove the <textarea> element\n                if (selected) {                                 // If a selection existed before copying\n                document.getSelection().removeAllRanges();    // Unselect everything on the HTML document\n                document.getSelection().addRange(selected);   // Restore the original selection\n                }\n            };\n\n            $('.js-link-copy').on('click', function(e) {\n                var querystring = generateQueryString();\n                var url = [location.origin, location.pathname, querystring].join('');\n                copyToClipboard(url);\n                $(e.target).text('Link copied!')\n\n            });\n\n            // add view more collapsibles around result groups\n            var $groups = $('.views-view-grid');\n            $groups.each(function(index, element) {\n                var heading = element.previousElementSibling;\n                console.log(heading.innerText + ' has ' + $(element).children('.card-deck').length + ' rows.');\n\n                if($(element).children('.card-deck').length > 2) {\n                    var collapsedElements = $(element).children(':nth-child(n+3)');\n                    var collapseWrap = $.parseHTML('<div class=\"collapse\" id=\"viewMoreCollapse' + heading.innerText + '\"></div>');\n                    var collapseAfter = $.parseHTML('<p><a aria-controls=\"viewMoreCollapse' + heading.innerText + '\" aria-expanded=\"false\" class=\"view-more-link collapsed\" data-target=\"#viewMoreCollapse' + heading.innerText + '\" data-toggle=\"collapse\" role=\"button\">View More</a></p>');\n                    $(collapsedElements).wrapAll(collapseWrap);\n                    var collapseContainer = $(collapsedElements).parent();\n                    $(collapseAfter).insertAfter(collapseContainer);\n                }\n            });\n\n            // make sure the view more events are added to our dynamically created view more elements\n            Drupal.behaviors.toggleViewMoreText.attach();\n        }\n    }\n})(jQuery, Drupal);\n\n"]}