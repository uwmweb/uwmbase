{"version":3,"sources":["search.js"],"names":["$","Drupal","behaviors","initSearchFacets","attach","context","settings","fn","selectpicker","Constructor","BootstrapVersion","$selects","each","j","k","$selectpicker","options","find","a","b","val","url","window","location","href","replace","indexOf","push","showFilters","addClass","on","e","clickedIndex","isSelected","previousValue","document","ready","initSearchForm","$searchForm","$searchInput","$selectFilters","$newSubmitButton","getSubmitUrl","opts","s","fs_p","f","g","length","pathname","param","attr","preventDefault","trigger","text","removeClass","click","jQuery"],"mappings":"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","file":"search.js","sourcesContent":["/**\n * @file\n * Custom JavaScript for UW Medicine.\n */\n\n(function ($, Drupal) {\n  Drupal.behaviors.initSearchFacets = {\n    attach(context, settings) {\n      $.fn.selectpicker.Constructor.BootstrapVersion = \"4\";\n\n      const $selects = $(\".selectpicker\");\n\n      $selects.each((j, k) => {\n        const $selectpicker = $(k);\n        const options = [];\n        $selectpicker.find(\"option\").each((a, b) => {\n          const val = $(b).val();\n          const url = window.location.href.replace(/%3A/g, \":\");\n          if (url.indexOf(val) > 0) {\n            // $(b).attr(\"selected\", \"selected\");\n            options.push(val);\n          }\n        });\n        $selectpicker.selectpicker(\"val\", options);\n      });\n\n      const showFilters = function () {\n        $(\".views-exposed-form, .dm-facets-selector, .submit-wrapper\").addClass(\n          \"on\"\n        );\n      };\n\n      $selects.selectpicker();\n      $selects.on(\n        \"loaded.bs.select\",\n        (e, clickedIndex, isSelected, previousValue) => {\n          showFilters();\n        }\n      );\n      $(document).ready(showFilters);\n    }\n  };\n  Drupal.behaviors.initSearchForm = {\n    attach(context, settings) {\n      const $searchForm = $(\"section.content-topper form.views-exposed-form\");\n      const $searchInput = $searchForm.find(\"input[name=s]\");\n      const $selectFilters = $(\"section.content-topper .selectpicker\");\n      const $newSubmitButton = $(\"section.content-topper .submit-wrapper a.btn\");\n\n      const getSubmitUrl = function () {\n        const opts = {s: $searchInput.val(), fs_p: [], f: []};\n\n        $selectFilters.find(\"option:selected\").each((f, g) => {\n          const val = $(g).val();\n          if (val.length > 0) {\n            if ($selectFilters.length > 1) {\n              opts.fs_p[opts.fs_p.length] = val;\n            }\n            else {\n              opts.f[opts.f.length] = val;\n            }\n          }\n        });\n\n        return `${window.location.pathname}?${$.param(opts)}`;\n      };\n\n      // http://stevie.uwmed.local/search/providers?fs_p[0]=language:15391&fs_p[1]=medical-service:506&fs_p[2]=medical-service:1321\n\n      $searchInput.attr(\"autocomplete\", \"off\");\n\n      $searchForm.on(\"submit\", e => {\n        e.preventDefault();\n        $newSubmitButton.trigger(\"click\");\n      });\n\n      const s = $searchInput.val();\n      if (s.length > 0) {\n        $(\"section.content-topper .all em\").text(s);\n        $(\".results-tip.zero-results\").addClass(\"hidden\");\n        $(\".results-tip.with-results\").removeClass(\"hidden\");\n      }\n\n      $newSubmitButton.click(function () {\n        $(this).attr(\"href\", getSubmitUrl());\n      });\n    }\n  };\n})(jQuery, Drupal);\n"]}