{"version":3,"sources":["search.js"],"names":["$","Drupal","behaviors","initSearchFacets","attach","context","settings","fn","selectpicker","Constructor","BootstrapVersion","$selects","find","each","a","b","val","url","window","location","href","indexOf","replace","attr","console","log","on","e","clickedIndex","isSelected","previousValue","addClass","initFormSubmit","submitUrl","opts","s","fs_p","f","g","push","pathname","param","$newSubmit","click","jQuery"],"mappings":";;AAAA;;;;;AAKA,CAAC,UAASA,CAAT,EAAYC,MAAZ,EAAoB;AACnBA,SAAOC,SAAP,CAAiBC,gBAAjB,GAAoC;AAClCC,UADkC,kBAC3BC,OAD2B,EAClBC,QADkB,EACR;AACxBN,QAAEO,EAAF,CAAKC,YAAL,CAAkBC,WAAlB,CAA8BC,gBAA9B,GAAiD,GAAjD;;AAEA,UAAMC,WAAWX,EAAE,eAAF,CAAjB;;AAEAW,eAASC,IAAT,CAAc,QAAd,EAAwBC,IAAxB,CAA6B,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACrC,YAAMC,MAAMhB,EAAEe,CAAF,EAAKC,GAAL,EAAZ;AACA,YAAMC,MAAMC,OAAOC,QAAP,CAAgBC,IAA5B;AACA,YAAIJ,IAAIK,OAAJ,CAAYJ,IAAIK,OAAJ,CAAY,MAAZ,EAAoB,GAApB,CAAZ,IAAwC,CAA5C,EAA+C;AAC7CtB,YAAEe,CAAF,EAAKQ,IAAL,CAAU,UAAV,EAAsB,UAAtB;AACAC,kBAAQC,GAAR,CAAY,UAAZ,EAAwBT,GAAxB;AACD;AACF,OAPD;;AASAL,eAASH,YAAT;AACAG,eAASe,EAAT,CACE,kBADF,EAEE,UAACC,CAAD,EAAIC,YAAJ,EAAkBC,UAAlB,EAA8BC,aAA9B,EAAgD;AAC9C9B,UACE,2DADF,EAEE+B,QAFF,CAEW,IAFX;AAGD,OANH;AAQD;AAxBiC,GAApC;AA0BA9B,SAAOC,SAAP,CAAiB8B,cAAjB,GAAkC;AAChC5B,UADgC,kBACzBC,OADyB,EAChBC,QADgB,EACN;AACxB,UAAM2B,YAAY,SAAZA,SAAY,GAAW;AAC3B,YAAMC,OAAO,EAAEC,GAAGnC,EAAE,eAAF,EAAmBgB,GAAnB,EAAL,EAA+BoB,MAAM,EAArC,EAAb;;AAEApC,UAAE,eAAF,EACGY,IADH,CACQ,iBADR,EAEGC,IAFH,CAEQ,UAACwB,CAAD,EAAIC,CAAJ,EAAU;AACd,cAAMtB,MAAMhB,EAAEsC,CAAF,EAAKtB,GAAL,EAAZ;AACAkB,eAAKE,IAAL,CAAUG,IAAV,CAAevB,GAAf;AACD,SALH;;AAOA,eAAOE,OAAOC,QAAP,CAAgBqB,QAAhB,GAA2B,GAA3B,GAAiCxC,EAAEyC,KAAF,CAAQP,IAAR,CAAxC;AACD,OAXD;;AAaA;;AAEA,UAAMQ,aAAa1C,EAAE,8CAAF,CAAnB;AACA0C,iBAAWC,KAAX,CAAiB,UAAShB,CAAT,EAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA3B,UAAE,IAAF,EAAQuB,IAAR,CAAa,MAAb,EAAqBU,WAArB;AAED,OATD;AAUD;AA5B+B,GAAlC;AA8BD,CAzDD,EAyDGW,MAzDH,EAyDW3C,MAzDX","file":"search.js","sourcesContent":["/**\n * @file\n * Custom JavaScript for UW Medicine.\n */\n\n(function($, Drupal) {\n  Drupal.behaviors.initSearchFacets = {\n    attach(context, settings) {\n      $.fn.selectpicker.Constructor.BootstrapVersion = \"4\";\n\n      const $selects = $(\".selectpicker\");\n\n      $selects.find(\"option\").each((a, b) => {\n        const val = $(b).val();\n        const url = window.location.href;\n        if (val.indexOf(url.replace(/%3A/g, \":\")) > 0) {\n          $(b).attr(\"selected\", \"selected\");\n          console.log(\"selected\", val);\n        }\n      });\n\n      $selects.selectpicker();\n      $selects.on(\n        \"loaded.bs.select\",\n        (e, clickedIndex, isSelected, previousValue) => {\n          $(\n            \".views-exposed-form, .dm-facets-selector, .submit-wrapper\"\n          ).addClass(\"on\");\n        }\n      );\n    }\n  };\n  Drupal.behaviors.initFormSubmit = {\n    attach(context, settings) {\n      const submitUrl = function() {\n        const opts = { s: $(\"input[name=s]\").val(), fs_p: [] };\n\n        $(\".selectpicker\")\n          .find(\"option:selected\")\n          .each((f, g) => {\n            const val = $(g).val();\n            opts.fs_p.push(val);\n          });\n\n        return window.location.pathname + '?' + $.param(opts);\n      };\n\n      // http://stevie.uwmed.local/search/providers?fs_p[0]=language:15391&fs_p[1]=medical-service:506&fs_p[2]=medical-service:1321\n\n      const $newSubmit = $(\"section.content-topper .submit-wrapper a.btn\");\n      $newSubmit.click(function(e) {\n        // const $form = $(this)\n        //   .parents(\"section.content-topper\")\n        //   .find(\"form.views-exposed-form\");\n        //\n        // e.preventDefault();\n        // $form.submit();\n        $(this).attr(\"href\", submitUrl());\n\n      });\n    }\n  };\n})(jQuery, Drupal);\n"]}