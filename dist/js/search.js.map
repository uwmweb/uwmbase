{"version":3,"sources":["search.js"],"names":["$","Drupal","behaviors","initSearchFacets","attach","context","settings","fn","selectpicker","Constructor","BootstrapVersion","$selects","each","j","k","$selectpicker","options","find","a","b","val","url","window","location","href","replace","indexOf","push","showFilters","addClass","on","e","clickedIndex","isSelected","previousValue","document","ready","initSearchForm","submitUrl","opts","s","fs_p","f","g","length","pathname","param","$searchBox","attr","text","$newSubmit","click","jQuery"],"mappings":";;AAAA;;;;;AAKA,CAAC,UAASA,CAAT,EAAYC,MAAZ,EAAoB;AACnBA,SAAOC,SAAP,CAAiBC,gBAAjB,GAAoC;AAClCC,UADkC,kBAC3BC,OAD2B,EAClBC,QADkB,EACR;AACxBN,QAAEO,EAAF,CAAKC,YAAL,CAAkBC,WAAlB,CAA8BC,gBAA9B,GAAiD,GAAjD;;AAEA,UAAMC,WAAWX,EAAE,eAAF,CAAjB;;AAEAW,eAASC,IAAT,CAAc,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACtB,YAAMC,gBAAgBf,EAAEc,CAAF,CAAtB;AACA,YAAME,UAAU,EAAhB;AACAD,sBAAcE,IAAd,CAAmB,QAAnB,EAA6BL,IAA7B,CAAkC,UAACM,CAAD,EAAIC,CAAJ,EAAU;AAC1C,cAAMC,MAAMpB,EAAEmB,CAAF,EAAKC,GAAL,EAAZ;AACA,cAAMC,MAAMC,OAAOC,QAAP,CAAgBC,IAAhB,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,GAArC,CAAZ;AACA,cAAIJ,IAAIK,OAAJ,CAAYN,GAAZ,IAAmB,CAAvB,EAA0B;AACxB;AACAJ,oBAAQW,IAAR,CAAaP,GAAb;AACD;AACF,SAPD;AAQAL,sBAAcP,YAAd,CAA2B,KAA3B,EAAkCQ,OAAlC;AACD,OAZD;;AAcA,UAAMY,cAAc,SAAdA,WAAc,GAAW;AAC7B5B,UAAE,2DAAF,EAA+D6B,QAA/D,CACE,IADF;AAGD,OAJD;;AAMAlB,eAASH,YAAT;AACAG,eAASmB,EAAT,CACE,kBADF,EAEE,UAACC,CAAD,EAAIC,YAAJ,EAAkBC,UAAlB,EAA8BC,aAA9B,EAAgD;AAC9CN;AACD,OAJH;AAMA5B,QAAEmC,QAAF,EAAYC,KAAZ,CAAkBR,WAAlB;AACD;AAlCiC,GAApC;AAoCA3B,SAAOC,SAAP,CAAiBmC,cAAjB,GAAkC;AAChCjC,UADgC,kBACzBC,OADyB,EAChBC,QADgB,EACN;AACxB,UAAMgC,YAAY,SAAZA,SAAY,GAAW;AAC3B,YAAMC,OAAO,EAAEC,GAAGxC,EAAE,eAAF,EAAmBoB,GAAnB,EAAL,EAA+BqB,MAAM,EAArC,EAAb;;AAEAzC,UAAE,eAAF,EACGiB,IADH,CACQ,iBADR,EAEGL,IAFH,CAEQ,UAAC8B,CAAD,EAAIC,CAAJ,EAAU;AACd,cAAMvB,MAAMpB,EAAE2C,CAAF,EAAKvB,GAAL,EAAZ;AACA,cAAIA,IAAIwB,MAAJ,GAAa,CAAjB,EAAoB;AAClBL,iBAAKE,IAAL,CAAUF,KAAKE,IAAL,CAAUG,MAApB,IAA8BxB,GAA9B;AACD;AACF,SAPH;;AASA,eAAUE,OAAOC,QAAP,CAAgBsB,QAA1B,SAAsC7C,EAAE8C,KAAF,CAAQP,IAAR,CAAtC;AACD,OAbD;;AAeA;;AAEA,UAAMQ,aAAa/C,EAAE,sCAAF,CAAnB;AACA+C,iBAAWC,IAAX,CAAgB,cAAhB,EAAgC,KAAhC;AACA,UAAMR,IAAIO,WAAW3B,GAAX,EAAV;AACA,UAAIoB,EAAEI,MAAF,GAAW,CAAf,EAAkB;AAChB5C,UAAE,gCAAF,EAAoCiD,IAApC,CAAyCT,CAAzC;AACD;;AAED,UAAMU,aAAalD,EAAE,8CAAF,CAAnB;AACAkD,iBAAWC,KAAX,CAAiB,UAASpB,CAAT,EAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA/B,UAAE,IAAF,EAAQgD,IAAR,CAAa,MAAb,EAAqBV,WAArB;AACD,OARD;AASD;AApC+B,GAAlC;AAsCD,CA3ED,EA2EGc,MA3EH,EA2EWnD,MA3EX","file":"search.js","sourcesContent":["/**\n * @file\n * Custom JavaScript for UW Medicine.\n */\n\n(function($, Drupal) {\n  Drupal.behaviors.initSearchFacets = {\n    attach(context, settings) {\n      $.fn.selectpicker.Constructor.BootstrapVersion = \"4\";\n\n      const $selects = $(\".selectpicker\");\n\n      $selects.each((j, k) => {\n        const $selectpicker = $(k);\n        const options = [];\n        $selectpicker.find(\"option\").each((a, b) => {\n          const val = $(b).val();\n          const url = window.location.href.replace(/%3A/g, \":\");\n          if (url.indexOf(val) > 0) {\n            // $(b).attr(\"selected\", \"selected\");\n            options.push(val);\n          }\n        });\n        $selectpicker.selectpicker(\"val\", options);\n      });\n\n      const showFilters = function() {\n        $(\".views-exposed-form, .dm-facets-selector, .submit-wrapper\").addClass(\n          \"on\"\n        );\n      };\n\n      $selects.selectpicker();\n      $selects.on(\n        \"loaded.bs.select\",\n        (e, clickedIndex, isSelected, previousValue) => {\n          showFilters();\n        }\n      );\n      $(document).ready(showFilters);\n    }\n  };\n  Drupal.behaviors.initSearchForm = {\n    attach(context, settings) {\n      const submitUrl = function() {\n        const opts = { s: $(\"input[name=s]\").val(), fs_p: [] };\n\n        $(\".selectpicker\")\n          .find(\"option:selected\")\n          .each((f, g) => {\n            const val = $(g).val();\n            if (val.length > 0) {\n              opts.fs_p[opts.fs_p.length] = val;\n            }\n          });\n\n        return `${window.location.pathname}?${$.param(opts)}`;\n      };\n\n      // http://stevie.uwmed.local/search/providers?fs_p[0]=language:15391&fs_p[1]=medical-service:506&fs_p[2]=medical-service:1321\n\n      const $searchBox = $(\"section.content-topper input[name=s]\");\n      $searchBox.attr(\"autocomplete\", \"off\");\n      const s = $searchBox.val();\n      if (s.length > 0) {\n        $(\"section.content-topper .all em\").text(s);\n      }\n\n      const $newSubmit = $(\"section.content-topper .submit-wrapper a.btn\");\n      $newSubmit.click(function(e) {\n        // const $form = $(this)\n        //   .parents(\"section.content-topper\")\n        //   .find(\"form.views-exposed-form\");\n        //\n        // e.preventDefault();\n        // $form.submit();\n        $(this).attr(\"href\", submitUrl());\n      });\n    }\n  };\n})(jQuery, Drupal);\n"]}