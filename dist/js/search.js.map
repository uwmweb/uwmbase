{"version":3,"sources":["search.js"],"names":["$","Drupal","behaviors","initSearchFacets","attach","context","settings","fn","selectpicker","Constructor","BootstrapVersion","$selects","each","j","k","$selectpicker","options","find","a","b","val","url","window","location","href","replace","indexOf","push","on","e","clickedIndex","isSelected","previousValue","addClass","initFormSubmit","submitUrl","opts","s","fs_p","f","g","length","pathname","param","$newSubmit","click","attr","jQuery"],"mappings":";;AAAA;;;;;AAKA,CAAC,UAASA,CAAT,EAAYC,MAAZ,EAAoB;AACnBA,SAAOC,SAAP,CAAiBC,gBAAjB,GAAoC;AAClCC,UADkC,kBAC3BC,OAD2B,EAClBC,QADkB,EACR;AACxBN,QAAEO,EAAF,CAAKC,YAAL,CAAkBC,WAAlB,CAA8BC,gBAA9B,GAAiD,GAAjD;;AAEA,UAAMC,WAAWX,EAAE,eAAF,CAAjB;;AAEAW,eAASC,IAAT,CAAc,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACtB,YAAMC,gBAAgBf,EAAEc,CAAF,CAAtB;AACA,YAAME,UAAU,EAAhB;AACAD,sBAAcE,IAAd,CAAmB,QAAnB,EAA6BL,IAA7B,CAAkC,UAACM,CAAD,EAAIC,CAAJ,EAAU;AAC1C,cAAMC,MAAMpB,EAAEmB,CAAF,EAAKC,GAAL,EAAZ;AACA,cAAMC,MAAMC,OAAOC,QAAP,CAAgBC,IAAhB,CAAqBC,OAArB,CAA6B,MAA7B,EAAqC,GAArC,CAAZ;AACA,cAAIJ,IAAIK,OAAJ,CAAYN,GAAZ,IAAmB,CAAvB,EAA0B;AACxB;AACAJ,oBAAQW,IAAR,CAAaP,GAAb;AACD;AACF,SAPD;AAQAL,sBAAcP,YAAd,CAA2B,KAA3B,EAAkCQ,OAAlC;AACD,OAZD;;AAcAL,eAASH,YAAT;AACAG,eAASiB,EAAT,CACE,kBADF,EAEE,UAACC,CAAD,EAAIC,YAAJ,EAAkBC,UAAlB,EAA8BC,aAA9B,EAAgD;AAC9ChC,UACE,2DADF,EAEEiC,QAFF,CAEW,IAFX;AAGD,OANH;AAQD;AA7BiC,GAApC;AA+BAhC,SAAOC,SAAP,CAAiBgC,cAAjB,GAAkC;AAChC9B,UADgC,kBACzBC,OADyB,EAChBC,QADgB,EACN;AACxB,UAAM6B,YAAY,SAAZA,SAAY,GAAW;AAC3B,YAAMC,OAAO,EAAEC,GAAGrC,EAAE,eAAF,EAAmBoB,GAAnB,EAAL,EAA+BkB,MAAM,EAArC,EAAb;;AAEAtC,UAAE,eAAF,EACGiB,IADH,CACQ,iBADR,EAEGL,IAFH,CAEQ,UAAC2B,CAAD,EAAIC,CAAJ,EAAU;AACd,cAAMpB,MAAMpB,EAAEwC,CAAF,EAAKpB,GAAL,EAAZ;AACA,cAAGA,IAAIqB,MAAJ,GAAa,CAAhB,EAAmB;AACjBL,iBAAKE,IAAL,CAAUF,KAAKE,IAAL,CAAUG,MAApB,IAA8BrB,GAA9B;AAED;AACF,SARH;;AAUA,eAAUE,OAAOC,QAAP,CAAgBmB,QAA1B,SAAsC1C,EAAE2C,KAAF,CAAQP,IAAR,CAAtC;AACD,OAdD;;AAgBA;;AAEA,UAAMQ,aAAa5C,EAAE,8CAAF,CAAnB;AACA4C,iBAAWC,KAAX,CAAiB,UAAShB,CAAT,EAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA7B,UAAE,IAAF,EAAQ8C,IAAR,CAAa,MAAb,EAAqBX,WAArB;AACD,OARD;AASD;AA9B+B,GAAlC;AAgCD,CAhED,EAgEGY,MAhEH,EAgEW9C,MAhEX","file":"search.js","sourcesContent":["/**\n * @file\n * Custom JavaScript for UW Medicine.\n */\n\n(function($, Drupal) {\n  Drupal.behaviors.initSearchFacets = {\n    attach(context, settings) {\n      $.fn.selectpicker.Constructor.BootstrapVersion = \"4\";\n\n      const $selects = $(\".selectpicker\");\n\n      $selects.each((j, k) => {\n        const $selectpicker = $(k);\n        const options = [];\n        $selectpicker.find(\"option\").each((a, b) => {\n          const val = $(b).val();\n          const url = window.location.href.replace(/%3A/g, \":\");\n          if (url.indexOf(val) > 0) {\n            //$(b).attr(\"selected\", \"selected\");\n            options.push(val);\n          }\n        });\n        $selectpicker.selectpicker(\"val\", options);\n      });\n\n      $selects.selectpicker();\n      $selects.on(\n        \"loaded.bs.select\",\n        (e, clickedIndex, isSelected, previousValue) => {\n          $(\n            \".views-exposed-form, .dm-facets-selector, .submit-wrapper\"\n          ).addClass(\"on\");\n        }\n      );\n    }\n  };\n  Drupal.behaviors.initFormSubmit = {\n    attach(context, settings) {\n      const submitUrl = function() {\n        const opts = { s: $(\"input[name=s]\").val(), fs_p: [] };\n\n        $(\".selectpicker\")\n          .find(\"option:selected\")\n          .each((f, g) => {\n            const val = $(g).val();\n            if(val.length > 0) {\n              opts.fs_p[opts.fs_p.length] = val;\n\n            }\n          });\n\n        return `${window.location.pathname}?${$.param(opts)}`;\n      };\n\n      // http://stevie.uwmed.local/search/providers?fs_p[0]=language:15391&fs_p[1]=medical-service:506&fs_p[2]=medical-service:1321\n\n      const $newSubmit = $(\"section.content-topper .submit-wrapper a.btn\");\n      $newSubmit.click(function(e) {\n        // const $form = $(this)\n        //   .parents(\"section.content-topper\")\n        //   .find(\"form.views-exposed-form\");\n        //\n        // e.preventDefault();\n        // $form.submit();\n        $(this).attr(\"href\", submitUrl());\n      });\n    }\n  };\n})(jQuery, Drupal);\n"]}